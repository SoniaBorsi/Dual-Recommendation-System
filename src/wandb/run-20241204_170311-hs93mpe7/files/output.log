2024-12-04 17:03:18,697 - ALS_Run_Train - INFO - Starting data loading...
2024-12-04 17:03:18,698 - DataUtils - INFO - Resolving paths for the demo MIND dataset...
2024-12-04 17:03:18,698 - DataUtils - INFO - Dataset located. Train: ./MINDdemo_train.zip/data/mind/train/behaviors.tsv, Valid: ./MINDdemo_train.zip/data/mind/valid/behaviors.tsv
2024-12-04 17:03:18,698 - DataUtils - INFO - Starting to preprocess MIND dataset. Train: ./MINDdemo_train.zip/data/mind/train/behaviors.tsv, Valid: ./MINDdemo_train.zip/data/mind/valid/behaviors.tsv
2024-12-04 17:03:24,114 - DataUtils - INFO - Schema of train_df:
root
 |-- userId: integer (nullable = true)
 |-- newsId: integer (nullable = true)
 |-- clicked: integer (nullable = false)
2024-12-04 17:03:24,119 - DataUtils - INFO - Preprocessing of MIND dataset completed.
2024-12-04 17:03:24,126 - ALS_Run_Train - INFO - Starting ALS training with data source: recommenders
2024-12-04 17:03:24,139 - ALS_Training - INFO - Starting ALS model training...
ERROR:root:Exception while sending command.
Traceback (most recent call last):
  File "/home/joaquin_l_calvo/.virtualenvs/data_mining/lib/python3.10/site-packages/py4j/clientserver.py", line 516, in send_command
    raise Py4JNetworkError("Answer from Java side is empty")
py4j.protocol.Py4JNetworkError: Answer from Java side is empty

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/joaquin_l_calvo/.virtualenvs/data_mining/lib/python3.10/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/home/joaquin_l_calvo/.virtualenvs/data_mining/lib/python3.10/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2024-12-04 17:03:41,270 - ALS_Run_Train - ERROR - An error occurred during training: An error occurred while calling o177.fit
ERROR:ALS_Run_Train:An error occurred during training: An error occurred while calling o177.fit
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/joaquin_l_calvo/Trento/Data_Mining/Data-Mining-Project/src/scripts/run_train_als.py", line 40, in <module>
    spark.stop()
  File "/home/joaquin_l_calvo/.virtualenvs/data_mining/lib/python3.10/site-packages/pyspark/sql/session.py", line 1796, in stop
    self._sc.stop()
  File "/home/joaquin_l_calvo/.virtualenvs/data_mining/lib/python3.10/site-packages/pyspark/context.py", line 654, in stop
    self._jsc.stop()
  File "/home/joaquin_l_calvo/.virtualenvs/data_mining/lib/python3.10/site-packages/py4j/java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
  File "/home/joaquin_l_calvo/.virtualenvs/data_mining/lib/python3.10/site-packages/py4j/java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
  File "/home/joaquin_l_calvo/.virtualenvs/data_mining/lib/python3.10/site-packages/py4j/clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
  File "/home/joaquin_l_calvo/.virtualenvs/data_mining/lib/python3.10/site-packages/py4j/clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "/home/joaquin_l_calvo/.virtualenvs/data_mining/lib/python3.10/site-packages/py4j/clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/joaquin_l_calvo/Trento/Data_Mining/Data-Mining-Project/src/scripts/run_train_als.py", line 40, in <module>
    spark.stop()
  File "/home/joaquin_l_calvo/.virtualenvs/data_mining/lib/python3.10/site-packages/pyspark/sql/session.py", line 1796, in stop
    self._sc.stop()
  File "/home/joaquin_l_calvo/.virtualenvs/data_mining/lib/python3.10/site-packages/pyspark/context.py", line 654, in stop
    self._jsc.stop()
  File "/home/joaquin_l_calvo/.virtualenvs/data_mining/lib/python3.10/site-packages/py4j/java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
  File "/home/joaquin_l_calvo/.virtualenvs/data_mining/lib/python3.10/site-packages/py4j/java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
  File "/home/joaquin_l_calvo/.virtualenvs/data_mining/lib/python3.10/site-packages/py4j/clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
  File "/home/joaquin_l_calvo/.virtualenvs/data_mining/lib/python3.10/site-packages/py4j/clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "/home/joaquin_l_calvo/.virtualenvs/data_mining/lib/python3.10/site-packages/py4j/clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [Errno 111] Connection refused
